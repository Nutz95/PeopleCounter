fusion_strategy: ASYNC_OVERLAY

models:
  yolo_global:
    enabled: true
    engine: models/tensorrt/yolo26n-seg-fp16-mixed.engine  # FP16 mixed precision
  yolo_tiles:
    enabled: false  # disabled — use yolo_global only; re-enable when density tiling is ready
    engine: models/tensorrt/yolo26n-seg-fp16-mixed.engine  # FP16 mixed precision
  density:
    enabled: true
    engine: models/tensorrt/dm_count_qnrf.engine

trt_execution:
  enabled: true
  strict_shape_check: true

yolo_tiles_parallel:
  enabled: false  # disabled while yolo_tiles is off
  groups: 2

inference_streams:
  yolo: true
  density: true

density:
  tiling: 4

streams:
  transfer: 0
  yolo: 1
  yolo_global_preprocess: 3
  yolo_tiles_preprocess: 4
  density: 2
  density_preprocess: 5

preprocess_branches:
  yolo_global_preprocess: true
  yolo_tiles_preprocess: false  # disabled with yolo_tiles
  density_preprocess: true

tensor_pool:
  max_per_key: 64

preprocess:
  yolo_global:
    target_width: 640
    target_height: 640
    mode: global
    overlap: 0.0
  yolo_tiles:
    target_width: 640
    target_height: 640
    mode: tiles
    overlap: 0.2

# ── MJPEG video feed (Flask /api/video) ─────────────────────────────────────
# max_height: int or null (null = native camera resolution, e.g. 4K).
#   Reduce to 1080 / 720 to limit bandwidth on slower networks.
#   When set, aspect ratio is preserved (even pixel width guaranteed).
# quality: NVJPEG quality 1-100. Higher = larger JPEG, better image.
video_stream:
  max_height: null   # null = native 4K; set to 2160/1440/1080/720 as needed
  quality: 99
